<section class="password-change">
  <form method="post"
        hx-post="{% url 'users:change_password' %}"
        hx-target=".profile-container"
        _="on submit add .is-submitting to me">
    {% csrf_token %}

    <div class="form-group">
      <label for="{{ form.old_password.id_for_label }}">Current Password</label>
      {{ form.old_password }}
      {{ form.old_password.errors }}
    </div>

    <div class="form-group">
      <label for="{{ form.new_password1.id_for_label }}">New Password</label>
      {{ form.new_password1 }}
      {{ form.new_password1.errors }}
      <small>{{ form.new_password1.help_text }}</small>
    </div>

    <div class="form-group">
      <label for="{{ form.new_password2.id_for_label }}">Confirm New Password</label>
      {{ form.new_password2 }}
      {{ form.new_password2.errors }}
    </div>

    <div class="form-actions">
      <button type="submit" class="btn-primary"
              _="on click if closest('form').classList.contains('is-submitting') then this.disabled = true
                            add {'loading': ''} to me
                            set my innerHTML to 'Changing...'">
        Change Password
      </button>

      <button type="button" class="btn-secondary"
              hx-get="{% url 'users:profile' %}"
              hx-target=".profile-container"
              hx-push-url="true">
        Cancel
      </button>
    </div>
  </form>
</section>
